from math import pi

import numpy as np

from sensor_msgs.msg import JointState
from motion import *

'''
pickup- [0.3707147538661957, -0.6427222458802795, -0.2488348742842285, 0.19985899129657744, 0.3433222957885742, -0.24732408942832945, 1.2769992243164063, 0.18256101062274932]
stall- [0.37060031294822693, -0.6419552533113098, -1.0280969401716797, 0.20062598386554717, 1.016356486920166, -0.13457649471416472, 1.4967419992797852, 0.18141053667045592]
0, 0 overhead - [0.3704706132411957, -0.19364934844604492, -0.9889805575728028, 0.2002424875810623, 1.456992644909668, -0.13457649471416472, 1.099057425152588, 0.18256101062274932]
0, 0 place- [0.36982211470603943, -0.20208626670471191, -0.9893639346479981, 0.20062598386554717, 1.722371120098877, -0.13534347983255385, 0.7623488794677734, 0.18102704038597106]
2, 1 overhead - [0.36181119084358215, 0.09205454903015137, -0.27874734605546875, 0.19372306564598082, -0.03250263249511719, -0.14071241291418074, 1.779761541973877, 0.18831343998886108]
2,1 place - [0.3617730438709259, 0.09128755646118164, -0.08469870294328613, 0.1929560879781723, -0.033269863482666015, -0.1410959091986656, 1.6351840387695313, 0.18831343998886108]
'''

pickup = [0.3707147538661957, -0.6427222458802795, -0.2488348742842285, 0.19985899129657744, 0.3433222957885742, -0.24732408942832945, 1.2769992243164063, 0.18256101062274932]
stall = [0.37060031294822693, -0.6419552533113098, -1.0280969401716797, 0.20062598386554717, 1.016356486920166, -0.13457649471416472, 1.4967419992797852, 0.18141053667045592]


def pick_and_place(x, y):

    # Take robot to stall position 
    go_to_joint(stall)

    # Gripper: open
    move_gripper(1)
    rospy.sleep(1)

    # Go to X
    go_to_joint(pickup)

    # Gripper: closed (picking up X)
    print('Picking up X')
    move_gripper(0)

    # Return to stall position (init position)
    go_to_joint(stall)

    # Hover above goal position
    go_to_joint(x)

    # Go to goal position
    go_to_joint(y)

    # Gripper: open (drop X)
    print('Releasing X')
    move_gripper(1)

    return

def main():
    rospy.init_node('test_motion')

    p00_overhead = [0.3704706132411957, -0.19364934844604492, -0.9889805575728028, 0.2002424875810623, 1.456992644909668, -0.13457649471416472, 1.099057425152588, 0.18256101062274932]
    p00_place = [0.36982211470603943, -0.20208626670471191, -0.9893639346479981, 0.20062598386554717, 1.722371120098877, -0.13534347983255385, 0.7623488794677734, 0.18102704038597106]
    p21_overhead = [0.36181119084358215, 0.09205454903015137, -0.27874734605546875, 0.19372306564598082, -0.03250263249511719, -0.14071241291418074, 1.779761541973877, 0.18831343998886108]
    p21_place = [0.3617730438709259, 0.09128755646118164, -0.08469870294328613, 0.1929560879781723, -0.033269863482666015, -0.1410959091986656, 1.6351840387695313, 0.18831343998886108]

    print('Going to (0, 0)')
    pick_and_place(p00_overhead, p00_place)

    rospy.sleep(2)

    print('Going to (2, 0)')
    pick_and_place(p21_overhead, p21_place)

    '''
    # Testing gripper 
    move_gripper(0)
    print('closed')

    move_gripper(1)
    print('open')
    '''
if __name__ == '__main__':
        main()